<% content_for :meta_title, "#{@avatar.user.nickname}" %>
<% content_for :meta_description, "Cet avatar a les skills suivantes #{ }"%>
<% content_for :meta_image, "#{cl_image_path(@avatar.user.avatar_picture.key)}" %>

<div class="avatar-page">

  <div data-controller="badge">
    <div class="avatar-page-resume">
      <div style="text-align: center">
        <%= image_tag "https://i.pinimg.com/originals/58/20/fe/5820fe42115912f3e21d6588c6d6637f.jpg", width: 100, height: 100, class: "avatar-picture", alt: "User Avatar", style: "margin-bottom: .5em;" %>
        <h3 class="avatar-page-level">Level <%= @avatar.level.current %></h3>
      </div>

      <div class="avatar-page-stats">
        <div class="avatar-resume-stat">
          <%= image_tag "stat-illustrations/ranking.svg", class: "stat-illustration" %>
          <p class="mb-0">Ranking</p>
          <p class="mb-0"> 288</p>
        </div>
        <div class="avatar-resume-stat">
          <%= image_tag "stat-illustrations/badge.svg", class: "stat-illustration" %>
          <p class="mb-0">Badges</p>
          <p class="mb-0"> <%= @my_badges.count %> / <%= @all_badges_count %></p>
        </div>
        <div class="avatar-resume-stat">
          <%= image_tag "stat-illustrations/xp.svg", class: "stat-illustration" %>
          <p class="mb-0">Total XP</p>
          <p class="mb-0"> <%= @user.total_xp %></p>
        </div>
      </div>
    </div>

    <!--
    <div class="xp my-3">
      <div class="xp-text">
        <p class="mb-0">XP : <%= @avatar.xp %> / <%= @avatar.level.to_next %></p>
        <p class="mb-0">To next level: <%= @avatar.to_next_level %></p>
      </div>
      <div class="xp-bar">
        <div class="xp-bar-progression" style="width: <%= @fill_percentage %>%"></div>
      </div>
    </div>
     -->

    <div data-controller="my-badges" id="myBadges">
      <%= render "my_badges", locals: { my_badges: @my_badges } %>

      <% @user_badges.each do |user_badge| %>
      <%= render "badge_card", badge: user_badge.badge, owned: true %>
      <% end %>

      <% @missing_badges.each do |missing_badge| %>
      <%= render "badge_card", badge: missing_badge, owned: false %>
      <% end %>
    </div>

  </div>

  <!--
  <div id="initialStats" class="d-none">
    <div><p>health</p><p><%#= @avatar.health %></p></div>
    <div><p>mana</p><p><%#= @avatar.mana %></p></div>
    <div><p>attack</p><p><%#= @avatar.attack %></p></div>
    <div><p>defense</p><p><%#= @avatar.defense %></p></div>
    <div><p>magic_power</p><p><%#= @avatar.magic_power %></p></div>
    <div><p>magic_defense</p><p><%#= @avatar.magic_defense %></p></div>
    <div><p>crit_rate</p><p><%#= @avatar.crit_rate %></p></div>
    <div><p>stamina</p><p><%#= @avatar.stamina %></p></div>
    <div><p>speed</p><p><%#= @avatar.speed %></p></div>
  </div>
   -->

</div>

    <%# @user_badges.each do |user_badge| %>
      <%#= render partial: "badge_card", locals: { badge: user_badge.badge, owned: true } %>
    <%# end %>

    <!--
    <div class="update-avatar">
      <div class="update-avatar-btn btn btn-primary hide" data-action="click->upgrade-avatar#update" data-upgrade-avatar-target="updateBtn">Save changes</div>
    </div>
     -->

    <%#= render "stats_and_skills", avatar: @avatar %>

    <!--
    <div class="items my-3">
      <h3>Items</h3>
      <i class="fa-solid fa-circle-question info-bubble"></i>
      <em class="mt-4">You don't have any items.</em>
      <em>Mobs will sometimes drop items when you defeat them.</em>
    </div>

    <div class="tournament my-3">
      <div class="tournament-btn btn btn-primary">Find Tournament</div>
    </div>

    <div class="see-ranking my-3">
      <div class="see-ranking-btn btn btn-primary">See Ranking</div>
    </div>
     -->

     <!--
    <div class="offcanvas offcanvas-bottom" tabindex="-1" id="offcanvasBottom" aria-labelledby="offcanvasBottomLabel">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="offcanvasBottomLabel">Available skills</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
      </div>
      <div class="offcanvas-body small">
        <%# @missing_skills.each do |skill| %>
        <p data-bs-dismiss="offcanvas" aria-label="Close" data-action="click->upgrade-avatar#addSkill"><%#= skill.name %></p>
        <%# end %>
      </div>
    </div>
      -->
